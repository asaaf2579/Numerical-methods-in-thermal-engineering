#include <iostream>
#include <cmath>
#include <vector>
using namespace std;

void tridiag_forw(vector<vector<double>> &A,vector<double> &b){
    int N=A.size();
    double l;
    for (int j=1; j<N; j++){
        l=A[j][j-1]/A[j-1][j-1];
        A[j][j]=A[j][j]-l*A[j-1][j];
        b[j]=b[j]-l*b[j-1];
    }
}

vector<double> tridiag_back(vector<vector<double>> &A,vector<double> &b){
    int N=A.size();
    vector<double> x(N);
    x[N-1]=b[N-1]/A[N-1][N-1];
    for (int i=N-2; i>=0; i--){
        x[i]=(b[i]-A[i][i+1]*x[i+1])/A[i][i];
    }
    return x;
}

void matrixmaker(vector<vector<double>> &A,vector<double> &b){
    int m=A.size();
    int N=m-1;
    A[0][0]=1, A[m-1][m-1]=1, A[0][1]=2, A[m-1][m-2]=2;
    for (int i=1; i<m-1 ; i++){
        A[i][i]=4;
        A[i][i-1]=1;
        A[i][i+1]=1;
    }
    vector<double> x(m);

    for (int i=0; i<m ; i++){
        x[i]=(3.0*i)/N;
    }
    
    
    b[0]=(m-1)*(-2.5*sin(5*x[0])+2*sin(5*x[1])+0.5*sin(5*x[2]));
    b[m-1]=(m-1)*(-2.5*sin(5*x[m-1])-2*sin(5*x[m-2])-0.5*sin(5*x[m-3]));
    for (int i=1; i<m-1 ; i++){
        b[i]=(m-1)*(sin(5*x[i+1])-sin(5*x[i-1]));
    }
    /*
    a more efficient way
    
    auto f = [&](double x){ return sin(5*x); };
    b[0]=N*(-2.5*f(x[0])+2*f(x[1])+0.5*f(x[2]));
    b[N]=N*(-2.5*f(x[N])-2*f(x[N-1])-0.5*f(x[N-2]));
    for (int i=1; i<N ; i++){
        b[i]=N*(f(x[i+1])-f(x[i-1]));
    }
    */
}

int main() {
    int N[3]={15,25,50};
    
    for (int i=0; i<3;i++){
        
        vector<vector<double>> A(N[i]+1,vector<double>(N[i]+1,0));
        vector<double> b(N[i]+1);
        vector<double> y(N[i]+1);
        
        cout<<"N= "<<N[i]<<endl;
        
        matrixmaker(A,b);
        
        cout<<"A="<<endl;
        for(int k=0;k<N[i]+1; k++){
        for(int l=0;l<N[i]+1; l++){
            cout<<A[k][l]<<" ";
        }cout<<endl;
        }
        
        cout<<endl;
        
        cout<<"b= "<<endl;
        for(int k=0;k<N[i]+1; k++){
            cout<<b[k]<<endl;   
        }
        
        tridiag_forw(A,b);
        
        y=tridiag_back(A,b);
        
        cout<<"\nx= "<<endl;
        for (int p=0; p<N[i]+1; p++){
        cout<<(3.0*p)/N[i]<<endl;
        }
        
        cout<<endl;
        
        cout<<"\ny= "<<endl;
        for (int j=0; j<N[i]+1; j++){
            cout<<y[j]<<endl;
        }
        
        cout<<endl;
    }

    return 0;
}


/*
Output

N= 15
A=
1 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 1 

b= 
32.0639
13.6395
-10.5053
-24.9915
-16.5007
7.1608
24.2387
19.0316
-3.67302
-23.0007
-21.1816
0.111723
21.3024
22.9077
3.45181
-57.2553

x= 
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
2.2
2.4
2.6
2.8
3


y= 
51.7816
-9.85885
1.29329
-5.8196
-3.00641
1.34456
4.78899
3.73815
-0.709988
-4.57122
-4.00582
-0.587135
6.46608
-3.97483
32.341
-121.937

N= 25
A=
1 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 1 

b= 
39.8826
23.301
10.2301
-6.4144
-20.8182
-27.9496
-25.3174
-13.8411
2.47028
17.9187
27.1076
26.8271
17.175
1.52328
-14.6606
-25.7231
-27.7998
-20.1652
-5.48635
11.1091
23.8238
28.2162
22.7518
9.33961
-7.3352
-100.722

x= 
0
0.12
0.24
0.36
0.48
0.6
0.72
0.84
0.96
1.08
1.2
1.32
1.44
1.56
1.68
1.8
1.92
2.04
2.16
2.28
2.4
2.52
2.64
2.76
2.88
3


y= 
62.3958
-11.2566
5.93153
-2.2394
-3.38832
-5.02552
-4.45918
-2.45515
0.438691
3.17067
4.79735
4.74756
3.03949
0.269544
-2.59439
-4.55262
-4.91829
-3.57405
-0.950763
1.89075
4.49684
3.94569
7.93656
-12.9401
53.1635
-207.049

N= 50
A=
1 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 4 1 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 1 

b= 
43.6681
28.2321
24.3903
18.3698
10.7084
2.09043
-6.71428
-14.9192
-21.7915
-26.7172
-29.2563
-29.182
-26.501
-21.4528
-14.4882
-6.22944
2.58577
11.17
18.7565
24.6674
28.375
29.5478
28.0813
24.1063
17.978
10.2438
1.59449
-7.19722
-15.346
-22.124
-26.9257
-29.3223
-29.0995
-26.2774
-21.108
-14.0531
-5.74284
3.08039
11.6285
19.1378
24.9376
28.5098
29.5353
27.9225
23.8155
17.5811
9.77625
1.09811
-7.67813
-15.7685
-190.002

x= 
0
0.06
0.12
0.18
0.24
0.3
0.36
0.42
0.48
0.54
0.6
0.66
0.72
0.78
0.84
0.9
0.96
1.02
1.08
1.14
1.2
1.26
1.32
1.38
1.44
1.5
1.56
1.62
1.68
1.74
1.8
1.86
1.92
1.98
2.04
2.1
2.16
2.22
2.28
2.34
2.4
2.46
2.52
2.58
2.64
2.7
2.76
2.82
2.88
2.94
3


y= 
67.7347
-12.0333
8.63066
1.90102
2.13509
0.267019
-1.11274
-2.53034
-3.68513
-4.5206
-4.94962
-4.93721
-4.48358
-3.6295
-2.45119
-1.05393
0.437475
1.8898
3.17332
4.17337
4.80063
4.99907
4.75095
4.07844
3.04162
1.7331
0.269765
-1.21767
-2.59633
-3.74306
-4.55544
-4.9609
-4.92322
-4.44575
-3.57117
-2.37758
-0.971609
0.521171
1.96731
3.23803
4.21833
4.82622
4.98659
4.76273
3.885
3.51275
-0.354904
7.68311
-29.2794
101.757
-393.515



=== Code Execution Successful ===

*/
